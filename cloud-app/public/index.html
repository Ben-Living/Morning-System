<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <title>Morning System</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,600;1,400&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header id="header">
      <div class="header-inner">
        <span id="header-date" class="header-date"></span>
        <div class="header-title">Morning System</div>
        <button id="menu-btn" class="icon-btn" title="Settings">⋯</button>
      </div>
      <!-- View tabs -->
      <div class="tab-bar">
        <button class="tab active" data-view="checkin">Check-In</button>
        <button class="tab" data-view="dashboard">Dashboard</button>
        <button class="tab" data-view="midday">Midday</button>
        <button class="tab" data-view="evening">Evening</button>
        <button class="tab" data-view="reflect">Reflect</button>
      </div>
    </header>

    <!-- Views -->
    <main id="main">

      <!-- ── Check-In View ── -->
      <div id="view-checkin" class="view active">
        <div id="checkin-status" class="status-bar hidden"></div>
        <div id="messages" class="messages-container"></div>
        <div class="input-area">
          <div class="input-row">
            <textarea
              id="chat-input"
              placeholder="Write here…"
              rows="1"
              autocomplete="off"
              autocorrect="on"
              spellcheck="true"
            ></textarea>
            <button id="send-btn" class="send-btn" title="Send">↑</button>
          </div>
          <div class="quick-actions">
            <button class="quick-btn" data-msg="Just tell me what's on top today.">Quick mode</button>
            <button class="quick-btn" id="score-morning-btn">Score day →</button>
            <button class="quick-btn" id="gen-dashboard-btn">Generate dashboard →</button>
          </div>
          <p class="dictate-hint">Tap the microphone on your keyboard to dictate</p>
        </div>
      </div>

      <!-- ── Dashboard View ── -->
      <div id="view-dashboard" class="view hidden">
        <div id="chart-container" class="chart-container hidden">
          <p class="chart-title">Life Wheel</p>
          <canvas id="life-wheel-canvas"></canvas>
        </div>
        <div id="dashboard-content" class="prose-content">
          <div class="empty-state">
            <p>No dashboard yet.</p>
            <p class="muted">Complete your morning check-in, then generate it.</p>
            <button id="gen-dashboard-btn-2" class="btn-primary">Generate dashboard</button>
          </div>
        </div>
      </div>

      <!-- ── Midday View ── -->
      <div id="view-midday" class="view hidden">
        <div id="midday-messages" class="messages-container"></div>
        <div class="input-area">
          <div class="input-row">
            <textarea
              id="midday-input"
              placeholder="How's the day tracking?"
              rows="1"
              autocomplete="off"
              autocorrect="on"
              spellcheck="true"
            ></textarea>
            <button id="midday-send-btn" class="send-btn" title="Send">↑</button>
          </div>
          <p class="dictate-hint">Tap the microphone on your keyboard to dictate</p>
        </div>
      </div>

      <!-- ── Evening Review View ── -->
      <div id="view-evening" class="view hidden">
        <div id="evening-messages" class="messages-container"></div>
        <div class="input-area">
          <div class="input-row">
            <textarea
              id="evening-input"
              placeholder="How did the day go?"
              rows="1"
              autocomplete="off"
              autocorrect="on"
              spellcheck="true"
            ></textarea>
            <button id="evening-send-btn" class="send-btn" title="Send">↑</button>
          </div>
          <div class="quick-actions">
            <button class="quick-btn" id="complete-day-btn">Complete day & save summary</button>
          </div>
          <p class="dictate-hint">Tap the microphone on your keyboard to dictate</p>
        </div>
      </div>

      <!-- ── Reflect View ── -->
      <div id="view-reflect" class="view hidden">
        <!-- Living Orientation -->
        <div id="orientation-section" class="orientation-section">
          <div class="orientation-header">
            <span class="orientation-label">Living Orientation</span>
            <button id="orientation-edit-btn" class="orientation-edit-btn">Edit</button>
          </div>
          <div id="orientation-display" class="orientation-display muted">Loading…</div>
          <div id="orientation-editor" class="orientation-editor hidden">
            <textarea id="orientation-textarea" rows="6" placeholder="Your orienting commitments…"></textarea>
            <div class="orientation-actions">
              <button id="orientation-save-btn" class="btn-primary-sm">Save</button>
              <button id="orientation-cancel-btn" class="btn-secondary-sm">Cancel</button>
            </div>
          </div>
        </div>

        <div id="reflect-messages" class="messages-container"></div>
        <div class="input-area">
          <div class="input-row">
            <textarea
              id="reflect-input"
              placeholder="What's on your mind?"
              rows="1"
              autocomplete="off"
              autocorrect="on"
              spellcheck="true"
            ></textarea>
            <button id="reflect-send-btn" class="send-btn" title="Send">↑</button>
          </div>
          <p class="dictate-hint">Tap the microphone on your keyboard to dictate</p>
        </div>
      </div>

    </main>

    <!-- Settings Panel -->
    <div id="settings-panel" class="panel hidden">
      <div class="panel-header">
        <h2>Settings</h2>
        <button id="close-settings" class="icon-btn">✕</button>
      </div>
      <div class="panel-body">
        <section>
          <h3>Google Accounts</h3>
          <div id="accounts-list" class="accounts-list"></div>
          <div class="connect-row">
            <input id="account-label" type="text" placeholder="Label (e.g. personal, work)" />
            <button id="connect-google-btn" class="btn-secondary">Connect Google account</button>
          </div>
        </section>

        <section>
          <h3>Mac Agent</h3>
          <div id="agent-status" class="agent-status">Checking…</div>
        </section>

        <section>
          <h3>Tracked Items</h3>
          <div id="tracked-items-list"></div>
          <div class="connect-row">
            <input id="new-tracked-item" type="text" placeholder="Add item to track…" />
            <button id="add-tracked-btn" class="btn-secondary">Add</button>
          </div>
        </section>

        <section>
          <h3>Current Aim</h3>
          <div id="aim-display"></div>
          <div id="aim-form" class="aim-form hidden">
            <input id="aim-heart-wish" type="text" placeholder="Heart wish (what your heart is longing for)" />
            <textarea id="aim-statement" placeholder="Aim statement (what you are practising)" rows="2"></textarea>
            <div class="aim-form-row">
              <input id="aim-start-date" type="date" title="Start date" />
              <input id="aim-end-date" type="date" title="End date (optional)" />
            </div>
            <input id="aim-accountability" type="text" placeholder="Accountability person (optional)" />
            <div class="connect-row">
              <button id="aim-save-btn" class="btn-secondary">Save aim</button>
              <button id="aim-cancel-btn" class="btn-secondary">Cancel</button>
            </div>
          </div>
          <div class="connect-row" id="aim-actions">
            <button id="aim-new-btn" class="btn-secondary">Set new aim</button>
          </div>
        </section>
      </div>
    </div>

    <!-- Life Wheel Scoring Modal -->
    <div id="score-modal" class="modal hidden">
      <div class="modal-inner">
        <div class="modal-header">
          <h2>Life Wheel Scores</h2>
          <button id="score-modal-close" class="icon-btn">✕</button>
        </div>
        <p class="muted" style="font-size:14px;margin-bottom:16px">Rate each area 1–10 based on how it feels right now.</p>
        <div id="score-sliders"></div>
        <div class="modal-footer">
          <button id="score-submit-btn" class="btn-primary">Save scores</button>
        </div>
      </div>
    </div>
    <div id="score-modal-overlay" class="overlay hidden"></div>
    <div id="settings-overlay" class="overlay hidden"></div>

    <!-- Loading overlay -->
    <div id="loading" class="loading-overlay hidden">
      <div class="spinner"></div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
  <script src="app.js"></script>
</body>
</html>
